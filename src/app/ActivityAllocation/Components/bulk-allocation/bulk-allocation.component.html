<div class="container">

  <div class="row">
    <!-- Date selection -->
    <div class="form-group col-md-6">
      <label>Activity From Date <span class="required">*</span></label>
      <div class="input-group">
        <input type="text" [(ngModel)]="selectedFromDate" class="form-control bold-black" bsDatepicker [bsConfig]="bsConfig" autocomplete="off" (ngModelChange)="setToDate()">
        <div class="input-group-append">
          <span class="input-group-text"><i class="material-icons">date_range</i></span>
        </div>
      </div>
    </div>
    <div class="form-group col-md-6">
      <label>Activity To Date <span class="required">*</span></label>
      <div class="input-group">
        <input type="text" [(ngModel)]="selectedToDate" class="form-control bold-black" bsDatepicker [bsConfig]="bsConfig" autocomplete="off" (ngModelChange)="validate()">
        <div class="input-group-append">
          <span class="input-group-text"><i class="material-icons">date_range</i></span>
        </div>
      </div>
    </div>
  </div>
  
  <div class="row">
    <!-- Activity selection -->
    <div class="form-group col-md-6">
      <label for="activity">Activity:</label>
      <select id="activity" class="form-control" [(ngModel)]="activity.activityId" (change)="onActivitySelect($event)">
        <option value="0">--select--</option>
        <option *ngFor="let activity of activities" [value]="activity.activityId">{{ activity.activityName }}</option>
      </select>
    </div>

    <!-- Session selection -->
    <div class="form-group col-md-6">
      <label for="session">Activity for:</label>
      <select id="session" class="form-control" [(ngModel)]="selectedSession">
        <option value="0">--select--</option>
        <option value="1">1st half</option>
        <option value="2">2nd half</option>
      </select>
    </div>
  </div>

  <!-- Activity timing -->
  <div class="form-row row">
    <div class="form-group col-md-6">
      <label for="selectedActivityFrom">Activity from:</label>
      <input type="time" class="form-control" [(ngModel)]="selectedActivityFrom">
    </div>
    <div class="form-group col-md-6">
      <label for="selectedActivityTo">Activity to:</label>
      <input type="time" class="form-control" [(ngModel)]="selectedActivityTo">
    </div>
  </div>

  <!-- Dynamic table for activities -->
  <table class="table mt-4" *ngIf="dynamicArray && dynamicArray.length > 0">
    <thead class="thead-dark">
      <tr>
        <th>Activity</th>
        <th>Session</th>
        <th>Time</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let dynamic of dynamicArray; let i = index;">
        <td>{{ dynamic.activity.activityName }}</td>
        <td>{{ dynamic.activityFor==1?'1st half':'2nd half' }}</td>
        <td>{{ dynamic.fromHours | convertTo12Hr }} &ndash; {{ dynamic.toHours | convertTo12Hr }}</td>
        <td><button class="btn btn-secondary btn-sm" (click)="edit(dynamic)">Edit</button></td>
      </tr>
    </tbody>
  </table>

  <!-- Select all resources checkbox -->
  <div class="form-check mt-3">
    <input type="checkbox" class="form-check-input custom-checkbox" id="selectAllResources" (change)="selectAllResources($event)">
    <label class="form-check-label custom-label" for="selectAllResources">Resources</label>
  </div>

  <mat-accordion *ngIf="platforms">
    <div *ngFor="let platform of platforms">
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>
            <div class="form-check">
              <input type="checkbox" class="form-check-input" id="platform{{platform.platformId}}" [checked]="platform.selected" (change)="togglePlatform($event, platform)">
              <label class="form-check-label" for="platform{{platform.platformId}}">
                {{ platform.platform }}
              </label>
            </div>
          </mat-panel-title>
        </mat-expansion-panel-header>
        <table class="table table-bordered">
          <thead>
            <tr>
              <th>Resource Name</th>
              <th>Resource Code</th>
              <th>Designation</th>
              <th>Years of experience</th>
            </tr>
          </thead>
          <tbody>
            <ng-container *ngFor="let resource of resources">
              <tr *ngIf="resource.platform.trim() == platform.platform.trim()">
                <td>
                  <div class="form-check">
                    <input type="checkbox" class="form-check-input" id="resource{{resource.resourceId}}" [checked]="resource.selected" (change)="toggle($event, resource.resourceId, platform.platformId)">
                    <label class="form-check-label" for="resource{{resource.resourceId}}">
                      {{ resource.resourceName }}
                    </label>
                  </div>
                </td>
                <td>{{resource.resourceCode}}</td>
                <td>{{resource.designation}}</td>
                <td>{{resource.experience}}</td>
              </tr>
            </ng-container>
          </tbody>
        </table>
      </mat-expansion-panel>
    </div>
  </mat-accordion>

  <!-- Submit button -->
  <button class="btn btn-success mt-3" (click)="submitForm()">{{editMode?'Update':'Submit'}}</button>
</div>
