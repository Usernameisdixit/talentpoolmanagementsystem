<div class="container">
  <h2 class="mb-4">Bulk Activity Allocation Form</h2>

  <!-- Activity selection -->
  <div class="form-group col-md-6">
    <label for="activity">Activity:</label>
    <select id="activity" class="form-control" (change)="onActivitySelect($event)">
      <option *ngFor="let activity of activities" [value]="activity.activityId">{{ activity.activityName }}</option>
    </select>
  </div>

  <!-- Session selection -->
  <div class="form-group col-md-6">
    <label for="session">Activity for:</label>
    <select id="session" class="form-control" [(ngModel)]="selectedSession">
      <option value="1">1st half</option>
      <option value="2">2nd half</option>
    </select>
  </div>

  <!-- Date selection -->
  <div class="form-group col-md-6">
    <label>Activity Date <span class="required">*</span></label>
    <div class="input-group">
      <input type="text" [(ngModel)]="selectedDate" class="form-control bold-black" bsDatepicker [bsConfig]="bsConfig" autocomplete="off">
      <div class="input-group-append">
        <span class="input-group-text"><i class="material-icons">date_range</i></span>
      </div>
    </div>
  </div>

  <!-- Activity timing -->
  <div class="form-row">
    <div class="form-group col-md-6">
      <label for="selectedActivityFrom">Activity from:</label>
      <input type="time" class="form-control" [(ngModel)]="selectedActivityFrom">
    </div>
    <div class="form-group col-md-6">
      <label for="selectedActivityTo">Activity to:</label>
      <input type="time" class="form-control" [(ngModel)]="selectedActivityTo">
    </div>
  </div>

  <!-- Activity details -->
  <div class="form-group">
    <label for="selectedDetails">Activity Details:</label>
    <textarea class="form-control" [(ngModel)]="selectedDetails"></textarea>
  </div>

  <!-- Add more button -->
  <button class="btn btn-primary mt-3" [disabled]="!activities || activities.length === 0" (click)="addMore()"><i class="fa fa-plus" aria-hidden="true"></i></button>

  <!-- Dynamic table for activities -->
  <table class="table mt-4" *ngIf="dynamicArray && dynamicArray.length > 0">
    <thead class="thead-dark">
      <tr>
        <th>Session</th>
        <th>Training</th>
        <th>Activity from</th>
        <th>Activity to</th>
        <th>Details</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let dynamic of dynamicArray; let i = index;">
        <td>{{ dynamic.activityFor }}</td>
        <td>{{ dynamic.activity.activityName }}</td>
        <td>{{ dynamic.fromHours }}</td>
        <td>{{ dynamic.toHours }}</td>
        <td>{{ dynamic.activityDetails }}</td>
        <td><button class="btn btn-danger btn-sm" (click)="removeRow($event,i)">Remove</button></td>
      </tr>
    </tbody>
  </table>

  <!-- Select all resources checkbox -->
  <div class="form-check mt-3">
    <input type="checkbox" class="form-check-input custom-checkbox" id="selectAllResources" (change)="selectAllResources($event)">
    <label class="form-check-label custom-label" for="selectAllResources">Resources</label>
  </div>

  <mat-accordion *ngIf="platforms">
    <div *ngFor="let platform of platforms">
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>
            <div class="form-check">
              <input type="checkbox" class="form-check-input" id="platform{{platform.platformId}}" [checked]="platform.selected" (change)="togglePlatform($event, platform)">
              <label class="form-check-label" for="platform{{platform.platformId}}">
                {{ platform.platform }}
              </label>
            </div>
          </mat-panel-title>
        </mat-expansion-panel-header>
        <table class="table table-bordered">
          <tbody>
            <ng-container *ngFor="let resource of resources">
              <tr *ngIf="resource.platform.trim() == platform.platform.trim()">
                <td>
                  <div class="form-check">
                    <input type="checkbox" class="form-check-input" id="resource{{resource.resourceId}}" [checked]="resource.selected" (change)="toggle($event, resource.resourceId, platform.platformId)">
                    <label class="form-check-label" for="resource{{resource.resourceId}}">
                      {{ resource.resourceName }}
                    </label>
                  </div>
                </td>
              </tr>
            </ng-container>
          </tbody>
        </table>
      </mat-expansion-panel>
    </div>
  </mat-accordion>

  <!-- Submit button -->
  <button class="btn btn-success mt-3" (click)="submitForm()">Submit</button>
</div>
